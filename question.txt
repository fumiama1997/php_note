3/22(金) 13:30 質問・確認内容 　次回の目標は22章を確実にして　23.24章に入っている状態にする。

21章 自動販売機 
tool.php 要件確認済み
コード修正

現在要件７の作業中 質問
要件7の仕様を実現する為にはどうすればよいか。イメージを知りたい。

次回の予約確認




フィードバック内容
21章要件はOK
HTML部分
  <td><input type="submit" value="<?php
                                                    if (($value['status']) === '1') {
                                                        print '公開→非公開';
                                                    } else {
                                                        print '非公開→公開';
                                                    }; ?>">
はvalueの中で分岐させるのではなく、もしstatusが１なら、０ならで分岐させ
その中で、statusが１なら０　０なら１へ変更するようにする。
そうすることで、php部分での１→０みたいな分岐をなくすことができる。




 if ((isset($_POST['name'])) && isset(($_POST['price'])) && isset(($_POST['piece'])) && isset(($_POST['file'])) && isset(($_POST['status']))) {
上記ビミョー
新規追加のsubmitが押されたら追加されるようにする。

if(empty($error)){}で各クエリ実行ごとにエラーがないか確認しながら進んでいたが
if (($result = mysqli_query($link, $query)) === false) {
                    $error[] = 'SQL失敗:' . $sql;
                } else 
とelse文でつなげることによりすっきりする。
今回の部分は修正したが、他の部分の上記のような修正ができる部分がある。
他の修正により今はできない状態の部分もあるので確認していく。

三種類のボタンがあり名前を付けるのか分からんが、
新規追加ボタンが押されたら、
在庫変更ボタンがおされたら？
ステータス変更ボタンが押されたか    判断できるようにしていく
 if (isset($_POST['drink_id'])) 
    の部分は在庫変更ボタンの処理とステータス変更ボタンの処理が混在しているので分ける。
    分けるためにもボタンごとに分けれるように考える。

下記の部分は省略できる。
新しく追加したオートインクリメントの値を取得できる関数がある。
なのでその関数を使ってdrink_idを取得し変数に入れ、次のinsertの際に使用する。
なので次のdrink_idが必要なクエリの直前でdrink_idを取得したらいいと思う。

 // 新しく追加した商品のdrink_idを取得
                    $query = 'SELECT drink_id FROM information_table ORDER BY drink_id DESC LIMIT 1 ';
                    if ($result = mysqli_query($link, $query)) {
                        // １件取得
                        $row = mysqli_fetch_assoc($result);
                        // 変数に格納
                        if (isset($row['drink_id']) === TRUE) {
                            $drink_id = $row['drink_id'];
                        }
                    } else {
                        $error[] = 'SQL失敗:' . $sql;
                    }
